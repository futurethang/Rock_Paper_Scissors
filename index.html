<!DOCTYPE html>
<html lang="en">

<head>
  <title>ROCK. PAPER. SCISSORS.</title><!-- Required meta tags -->
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <link href="https://fonts.googleapis.com/css?family=Baloo+Bhai|Bungee+Inline|Fredoka+One|Special+Elite" rel="stylesheet"><!-- Bootstrap CSS -->
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" rel="stylesheet">
  <link href="style.css" rel="stylesheet">
</head>

<body>
  <div class="container">
    <div class="row score_row">
      <div class="col-md-6">
        <div class="card score_card" style="width: 18rem;">
          <div class="card-body">
            <h5 class="card-title">YOU:</h5><img alt="rock paper scissors image" class="game_image" id="user_image" src="images/placeholder.jpg">
            <h1 class="text_result" id="user"></h1><span class="text_result">score:</span> <span class="score_keep" id="userScore"></span>
          </div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card score_card" style="width: 18rem;">
          <div class="card-body">
            <h5 class="card-title">COMPUTER:</h5><img alt="rock paper scissors image" class="game_image" id="cpu_image"
              src="images/placeholder.jpg">
            <h1 class="text_result" id="computer"></h1><span class="text_result">score:</span> <span class="score_keep"
              id="computerScore"></span>
          </div>
        </div>
      </div>
    </div>
    <div class="row next_throw">
      <div class="col-md-12 next_throw">
        <a class="rps_pick btn btn-primary" href="#" id="rock" name="" role="button">Rock</a>
        <a class="rps_pick btn btn-primary" href="#" id="paper" name="" role="button">Paper</a>
        <a class="rps_pick btn btn-primary" href="#" id="scissors" name="" role="button">Scissors</a>
      </div>
    </div>
    <div class="row result">
      <div class="col-md-8">
        <span class="result_text" id="result"></span>
      </div>
    </div>
    <div class="row game_count">
      <div class="col-md-8">
        Games Played: <span class="game_count_text" id="games"></span>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <div id="game"></div>
      </div>
    </div>
  </div>
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.5.2/firebase.js">

  </script>

  <!-- INITIALIZE FIREBASE -->
  <script>
    var config = {
      apiKey: "AIzaSyD5-SyabL6PhCSNtNtYk4P4MMTzwdEJWsU",
      authDomain: "rock-paper-scissors-a1395.firebaseapp.com",
      databaseURL: "https://rock-paper-scissors-a1395.firebaseio.com",
      projectId: "rock-paper-scissors-a1395",
      storageBucket: "",
      messagingSenderId: "556958634970"
    };
    firebase.initializeApp(config);
  </script>

  <script type="text/javascript">
    // HTML WRITING VARIABLES
    var userText = document.getElementById("user");
    var computerText = document.getElementById("computer");
    var result = document.getElementById("result");
    var userScore = document.getElementById("userScore");
    var computerScore = document.getElementById("computerScore");
    var html_user_image = document.getElementById("user_image");
    var html_cpu_image = document.getElementById("cpu_image");
    var num_games = document.getElementById("games");

    // GAME READY DOM
    function gameChoiceReset() {
      html_user_image.src = "images/placeholder.jpg"
      html_cpu_image.src = "images/placeholder.jpg"
    }


    // SET THE FIREBASE VARIABLES
    var fbRef = firebase.database().ref();
    // the user selects a play and hits "submit"
    // requires action to store the selection in variable to send to fbRef
    // requires submit DOM element
    // "Submit" writes the user choice to the right firebase ref for that player
    // fbRef.push(player1selection, player2selection,);
    // it waits for a second input to move forward
    // once a choice is made by both players, it runs to compare the selections
    // game(player1selection, player2selection);
    // displays are updated for each player
    // 
    // values for games won/lost are written to fbRef
    // fbRef.set(winner, loser);
    // new game ready

    // SET THE USER AND COMPUTER VARIABLES      
    var computerChoices = ["rock", "paper", "scissors"];
    var userScore_count = 0;
    var computerScore_count = 0;
    var num_games_count = 0;
    var userGuess;
    var computerGuess = function () { return computerChoices[Math.floor(Math.random() * computerChoices.length)]; }
    var computerReturn = function (play) {
      var text;
      switch (play) {
        case "rock":
          text = "ROCK"
          html_cpu_image.src = "images/rock.jpg"
          break;
        case "paper":
          text = "PAPER"
          html_cpu_image.src = "images/paper.jpg"
          break;
        case "scissors":
          text = "SCISSORS"
          html_cpu_image.src = "images/scissors.jpg"
          break;
      }
      return text;
    }

    // USER PLAYS ROCK
    // $("#rock").on("click", )
    $(".rps_pick").on("click", function () {

      userGuess = $(this).prop('id');
      userText.textContent = userGuess;
      alert(userGuess);

      // DOM UPDATE, REMOVE INTO FUNCTION
      html_user_image.src = "images/" + userGuess + ".jpg"

      let play = computerGuess();

      // DOM UPDATE, REMOVE INTO FUNCTION
      computerText.textContent = computerReturn(play);

      return game(userGuess, play);
    })

    // THIS FUNCTION RUNS THE GAME CONDITIONS
    let game = function (user, computer) {
      num_games_count++;
      num_games.textContent = num_games_count;

      if (user == computer) {
        result.textContent = "Tie!";
        result.style = "color: rgb(99, 189, 187)";
      } else if (user == "rock") {
        if (computerock == "scissors") {
          userScore_count = userScore_count + 1;
          // userScore_count ++;

          // DOM UPDATE, REMOVE INTO FUNCTION
          result.textContent = "WIN";
          result.style = "color: rgb(245, 188, 74)";

        } else if (computer == "paper") {
          computerScore_count = computerScore_count + 1;
          result.textContent = "YOU LOSE";
          result.style = "color: rgb(243, 102, 82)";
        }
      } else if (user == "paper") {
        if (computer == "rock") {
          userScore_count = userScore_count + 1;

          // DOM UPDATE, REMOVE INTO FUNCTION
          result.textContent = "WIN";
          result.style = "color: rgb(245, 188, 74)";

        } else if (computer == "scissors") {
          computerScore_count = computerScore_count + 1;

          // DOM UPDATE, REMOVE INTO FUNCTION
          result.textContent = "YOU LOSE";
          result.style = "color: rgb(243, 102, 82)";

        }
      } else if (user == "scissors") {
        if (computer == "paper") {
          userScore_count++;

          // DOM UPDATE, REMOVE INTO FUNCTION
          result.textContent = "WIN";
          result.style = "color: rgb(245, 188, 74)";

        } else if (computer == "rock") {
          computerScore_count = computerScore_count + 1;

          // DOM UPDATE, REMOVE INTO FUNCTION
          result.textContent = "YOU LOSE";
          result.style = "color: rgb(243, 102, 82)";

        }
      }

      // DOM UPDATE, REMOVE INTO FUNCTION
      userScore.textContent = userScore_count;
      computerScore.textContent = computerScore_count;
    }

  </script> <!-- Optional JavaScript -->
</body>

</html>